<!doctype html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<title>Solution UI</title>
		
		<link rel="stylesheet" href="css/common.css">
		<link rel="stylesheet" href="css/style.css">
		<link rel="stylesheet" href="css/dashboard.css">
		<script src="js/jquery.min.js"></script>
		<script src="js/common.js"></script>
		<script src="js/icon.js"></script>
		<script src="js/bootstrap.bundle.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		
	</head>
	<body class="bgcolor04">
		
		<!--SMTP 설정 모달창 시작-->
		<div class="modal fade" id="smtpModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered">
				<div class="modal-content">
					<div class="modal-header">
						<div class="title">SMTP 설정하기</div>
						<span class="fs90 fc-gray pl20 mt-2">안내문구 추가</span>
						<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
					</div>
					<div class="modal-body">

						<table class="table table-borderless table-search">
							<tr>
								<th style="width:20%;">SMTP 사용여부</th>
								<td style="width:80%;">
									<label class="toggle_switch">
										<input type="checkbox" checked>
										<span class="slider"></span>
									</label>
									<span class="fs90 fc-main pl20"> <i class="fa-solid fa-circle-info"></i> 비활성화 시 SMTP 정보가 모두 초기화됩니다.</span>
								</td>
							</tr>
							<tr>
								<th>메일 서버 ID</th>
								<td>
									<input type="text" class="form-control w100p" placeholder="메일 서버 ID를 입력해주세요. 예) admin 또는 admin@example.com" onfocus="this.placeholder = ''">
								</td>
							</tr>
							<tr>
								<th>메일 서버 패스워드</th>
								<td>
									<input type="text" class="form-control w100p" placeholder="패스워드 변경 시에만 입력해주세요." onfocus="this.placeholder = ''">
								</td>
							</tr>
							<tr>
								<th>TLS 지원 메일 서버</th>
								<td>
									<input type="text" class="form-control w100p" placeholder="TLS 지원 메일 서버를 입력해주세요. 예) smtp.example.com" onfocus="this.placeholder = ''">
								</td>
							</tr>
							<tr>
								<th>메일 서버 포트</th>
								<td>
									<input type="text" class="form-control w100p" placeholder="메일 서버 포트를 숫자로 입력해주세요." onfocus="this.placeholder = ''">
								</td>
							</tr>
						</table>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn-text" data-bs-dismiss="modal">취소하기</button>
						<button type="button" class="btn-text-fill" data-bs-dismiss="modal">저장하기</button>
					</div>
				</div>
			</div>
		</div>
		<!--SMTP 설정 모달창 끝-->

		<div class="wrap">
			<!--Top Head 시작-->
			<div class="top-head">
				<div class="logo"><a href="dashboard.html"><img src="images/logo-swgv10.svg"></a></div>
				<div class="position-absolute top-50 start-0 translate-middle" style="margin-left:480px;">
					<button class="btn btn-state">MINOR <span class="fw-bold badge bgc-gray"> 0</span></button>
					<button class="btn btn-state">MAJOR <span class="fw-bold badge bgc-gray"> 3</span></button>
					<button class="btn btn-state">CRITICAL <span class="fw-bold badge bgc-red"> 0</span></button>
				</div>

				<div class="top-right position-absolute top-50 end-0 translate-middle-y">
					<div class="input-group btn-time mr10">
						<span class="form-control">00:31</span>
						<button class="btn btn-outline-secondary" type="button">Refresh</button>
					</div>
					<select class="mr10" style="width:100px;">
						  <option selected>admin</option>
						  <option value="1">나의 정보</option>
						  <option value="2">로그 아웃</option>
					</select>
					<ul>
						<li><i class="fa-solid fa-comment head-icon"></i></li>
						<li><i class="fa-solid fa-circle-question head-icon"></i></li>
						<li><i class="fa-solid fa-print head-icon"></i></li>
						<li><i class="fa-solid fa-gear head-icon" id="setcolorbtn"></i></li>
					</ul>
				</div>
				<div id="setcolor" style="display:none;">
						<table>
							<tr>
								<td class="w40p">갱신주기</td>
								<td>
									<select>
										<option selected>---갱신주기---</option>
										<option></option>
									</select>
								</td>
							</tr>
							<tr>
								<td>세션 타임아웃</td>
								<td>
									<select>
										<option selected>---갱신주기---</option>
										<option></option>
									</select>
								</td>
							</tr>
							<tr>
								<td>배경색</td>
								<td class="bgcolor">
									<button class="bgcolor01" id="bgcolor01"></button>
									<button class="bgcolor02" id="bgcolor02"></button>
									<button class="bgcolor03" id="bgcolor03"></button>
									<button class="bgcolor04" id="bgcolor04"></button>
									<button class="bgcolor05" id="bgcolor05"></button>
									<button class="bgcolor06" id="bgcolor06"></button>
									<button class="bgcolor07" id="bgcolor07"></button>
									<button class="bgcolor08" id="bgcolor08"></button>
									<button class="bgcolor09" id="bgcolor09"></button>
								</td>
							</tr>
							<tr style="border-bottom:0;">
								<td>기타 설정</td>
								<td>
									<label class="toggle_switch">
										<input type="checkbox">
										<span class="slider"></span>
									</label>
								</td>
							</tr>
						</table>
					</div>
				</div>
			<!--Top 끝-->

			<!--Left Menu 시작-->
			<div class="leftmenu">
				<div class="leftmenu-body">
					<div id="leftmenu" class="accordion">
						<div>
							<div class="menu-m on">
								<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#smenu1" aria-expanded="true" aria-controls="smenu1">
								<i class="fa-solid fa-database"></i> 정보
								</button>
							</div>
							<div id="smenu1" class="accordion-collapse collapse menu-s show" data-bs-parent="#leftmenu">
								<ul>
									<li>일반</li>
									<li class="on">통계</li>
									<li>실시간로그</li>
									<li>하드웨어</li>
								</ul>
							</div>
						</div>	
						<div>	
							<div class="menu-m">
								<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#smenu2" aria-expanded="false" aria-controls="smenu2">
								<i class="fa-solid fa-magnifying-glass-chart"></i> 분석
								</button>
							</div>
							<div id="smenu2" class="accordion-collapse collapse menu-s" data-bs-parent="#leftmenu">
								<ul>
									<li>클러스터링 트래픽 통계</li>
									<li>클러스터링 로그 검색</li>
									<li>트래픽 통계</li>
									<li>로그 검색</li>
									<li>리포트</li>
								 </ul>
							</div>
						</div>
						<div>
							<div class="menu-m">
								<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#smenu3" aria-expanded="false" aria-controls="smenu3">
								<i class="fa-solid fa-clipboard-check"></i> 정책
								</button>
							</div>
							<div id="smenu3" class="accordion-collapse collapse menu-s" data-bs-parent="#leftmenu">
								<ul>
									<li>클러스터링 트래픽 통계</li>
									<li>클러스터링 로그 검색</li>
									<li>트래픽 통계</li>
									<li>로그 검색</li>
									<li>리포트</li>
								 </ul>
							</div>
						</div>	
						<div>
							<div class="menu-m">
								<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#smenu4" aria-expanded="false" aria-controls="smenu4">
								<i class="fa-solid fa-eye"></i> 복호화
								</button>
							</div>
							<div id="smenu4" class="accordion-collapse collapse menu-s" data-bs-parent="#leftmenu">
								<ul>
									<li>복호화 제어</li>
									<li>미러링 설정</li>
									<li>인증서 관리</li>
									<li>서버 복호화</li>
								 </ul>
							</div>
						</div>	
						<div>
							<div class="menu-m">
								<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#smenu5" aria-expanded="false" aria-controls="smenu5">
								<i class="fa-solid fa-gear"></i> 설정
								</button>
							</div>
							<div id="smenu5" class="accordion-collapse collapse menu-s" data-bs-parent="#leftmenu">
								<ul>
									<li>네트워크</li>
									<li>라이선스</li>
									<li>시스템 관리</li>
									<li>바이패스</li>
									<li>업데이트/DB</li>
									<li>기타 설정</li>
									<li>재시작 / 종료</li>
								 </ul>
							</div>
						</div>

					</div>
				</div>
			</div>
			<!--Left Menu 끝-->
			
			<!-- 본문 시작 -->
			<div class="container-menu">
				<!--인증서관리 시작-->
				<div class="bg-content">
					<div class="c-title">
						<div class="float-start align-text-bottom"><h1>시스템 트래픽 통계</h1></div>
						<div class="float-end">
							<select><option selected>2023-02-01</option></select>
							~
							<select><option selected>2023-02-01</option></select>

							<div class="btn-group" role="group">
								<input type="radio" class="btn-check" name="btnradio" id="log1" autocomplete="off" checked>
								<label class="btn btn-tab" for="log1">오늘</label>

								<input type="radio" class="btn-check" name="btnradio" id="log2" autocomplete="off">
								<label class="btn btn-tab" for="log2">최근7일</label>

								<input type="radio" class="btn-check" name="btnradio" id="log3" autocomplete="off">
								<label class="btn btn-tab" for="log3">최근 30일</label>
							</div>
						</div>
					</div>
					<div class="mt20">
						<div class="d-flex">
							<div class="w50p pr10">
								<table class="demotable ml10 mr10">
									<tr>
										<td rowspan="3" class="cp" style="width:60%" id="trafficSelector">
											<span class="demofont" data-type="IN">IN</span> 
											<span class="demofont off" data-type="OUT">OUT</span>
										</td>
										<td class="fc-gray" style="width:18%">SWG</td>
										<td class="right pr10" style="width:18%" id="swgValue">1,943</td>
									</tr>
									<tr>
										<td class="fc-gray">VPN</td>
										<td class="right pr10" id="vpnValue">1,943</td>
									</tr>
									<tr>
										<td class="fc-gray">DLP</td>
										<td class="right pr10" id="dlpValue">112</td>
									</tr>
								</table>
							</div>
							<div class="w50p pl10">
								<div class="dash-graph-box">
									<canvas id="systemTrafficChart"></canvas>
								</div>
							</div>
						</div>
					</div>
				</div>
				
				<div class="bg-content">
					<div class="c-title">
						<div class="float-start align-text-bottom"><h1>인증서 등록</h1></div>
						<div class="float-end">
							<button class="btn btn-text">취소하기</button>
							<button class="btn btn-text-fill">등록하기</button>
						</div>
					</div>
					<div>
						<table class="table active">
							<thead>
								<tr class="center">
									<th>No</th>
									<th>인증서 이름</th>
									<th>인증서 종류</th>
									<th>개인키 파일명</th>
									<th>공용키 파일명</th>
									<th>등록일시</th>
									<th>만료일시</th>
									<th>삭제</th>
								</tr>
							</thead>
							<tbody>
								<tr class="center">
									<td>1</td>
									<td>ㅇㄴㄹㄴㅇㄹㄹ</td>
									<td>sdf</td>
									<td>2023-10-01 00:00</td>
									<td>172.31.23.124</td>
									<td>123</td>
									<td>172.12.13.12</td>
									<td><button class="btn-icon-sub"><i class="fa-solid fa-trash-can"></i></button></td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
				<!--인증서관리 끝-->
				
				<!--서버관리 시작-->
				<div class="bg-content">	
					<div class="d-flex justify-content-between">
						<div class="float-start">
							<select class="w300">
								<option selected>등록된 웹 서버 선택하기</option>
								<option>111.111.111.1</option>
								<option>111.111.111.1</option>
							</select>
						</div>
						<div class="float-end right"><button class="btn-text hvr-icon-pop"><i class="fa-solid fa-plus hvr-icon pr5"></i> 서버 추가하기</button></div>
					</div>
				</div>
				
				<div class="bg-content">
					<div class="c-title">
						<div class="float-start align-text-bottom"><h1>서버 기본정보 등록</h1></div>
						<div class="float-end">
							<button class="btn btn-text">취소하기</button>
							<button class="btn btn-text-fill">등록하기</button>
						</div>
					</div>
					<div>
						<table class="table table-borderless table-search mb10">
							<tr>
								<th style="width:10%;">서버 도메인</th>
								<td style="width:40%;">
									<input type="text" class="form-control w70p" placeholder="서버의 도메인을 입력하세요" onfocus="this.placeholder = ''">
								</td>
								<th style="width:10%;">서버 IP</th>
								<td style="width:40%;">
									<input type="text" class="form-control w70p" placeholder="서버의 IP를 입력하세요" onfocus="this.placeholder = ''">
								</td>
							</tr>
							<tr>
								<th>서버 프로토콜 / 포트</th>
								<td>
									<select class="w70p">
										<option selected>프토로톨 선택</option>
										<option>111.111.111.1</option>
									</select>
								</td>
								<th>서버 별칭</th>
								<td>
									<input type="text" class="form-control w70p" placeholder="사용자만의 별칭을 입력하여 관리할 수 있습니다" onfocus="this.placeholder = ''">
								</td>
							</tr>
							<tr>
								<th>서버 ACL 정책</th>
								<td>
									<select class="w70p">
										<option selected>ACL 정책 선택</option>
										<option>111.111.111.1</option>
									</select>
								</td>
								<th>서버 파일/스크립트 정책</th>
								<td>
									<select class="w70p">
										<option selected>보안 정책 선택</option>
										<option>111.111.111.1</option>
									</select>
								</td>
							</tr>
							<tr>
								<th>URL 정책</th>
								<td>
									<select class="w70p">
										<option selected>URL 정책 선택</option>
										<option>111.111.111.1</option>
									</select>	
								</td>
								<th>서버 정책 그룹</th>
								<td>
									<select class="w70p">
										<option selected>정책 그룹 선택</option>
										<option>111.111.111.1</option>
									</select>
								</td>

							</tr>
						</table>
					</div>
				</div>
				<!--서버관리 끝-->
				
			</div>
			<!-- 본문 끝 -->
			
			<!--풋터 시작-->
			<div class="footer center">
				<span>ⓒ SOOSAN INT Co.,Ltd. eWalker SWG V10 10.0.1.23011201-2213715</span> <span class="fc-main"> DEMO-LICENSE 42 days left.</span>
			</div>
			<!--풋터 끝-->
		</div>
		
		<script>
		$(document).ready(function() {
			// IN/OUT 데이터 정의
			const trafficData = {
				IN: {
					SWG: 1943,
					VPN: 1943,
					DLP: 112,
					chart: {
						SWG: [1943, 1850, 1920, 2100, 2080, 1943, 1950, 2000, 1900, 2050, 1980, 2020],
						VPN: [1943, 1800, 1880, 2050, 2030, 1943, 1920, 1980, 1880, 2020, 1950, 2000],
						DLP: [112, 105, 110, 120, 115, 112, 108, 118, 105, 125, 110, 115]
					}
				},
				OUT: {
					SWG: 1520,
					VPN: 1480,
					DLP: 890,
					chart: {
						SWG: [1520, 1450, 1500, 1650, 1620, 1520, 1550, 1600, 1500, 1650, 1580, 1620],
						VPN: [1480, 1400, 1450, 1580, 1550, 1480, 1500, 1550, 1450, 1600, 1520, 1580],
						DLP: [890, 850, 880, 950, 920, 890, 900, 930, 880, 960, 910, 940]
					}
				}
			};
			
			let currentType = 'IN';
			let systemTrafficChart = null;
			
			// 차트 초기화 함수
			function initChart() {
				const ctx = document.getElementById('systemTrafficChart');
				if (!ctx) return;
				
				// 기존 차트가 있으면 제거
				if (systemTrafficChart) {
					systemTrafficChart.destroy();
				}
				
				const data = trafficData[currentType];
				const textColor = getComputedStyle(document.body).getPropertyValue('--chart-text-color').trim() || 
								 getComputedStyle(document.body).getPropertyValue('--c-text').trim() || '#ffffff';
				
				// 메인 색상 가져오기
				const getMainColor = function() {
					const mainColor = getComputedStyle(document.body).getPropertyValue('--c-main').trim();
					return mainColor || 'rgba(54, 162, 235, 1)';
				};
				
				// 차트 색상 가져오기
				const getChartColor = function(type, opacity) {
					const colorMap = {
						'PRIMARY': '--chart-primary',
						'SECONDARY': '--chart-secondary',
						'TERTIARY': '--chart-tertiary'
					};
					const cssVar = colorMap[type] || '--c-main';
					let color = getComputedStyle(document.body).getPropertyValue(cssVar).trim();
					if (!color) {
						color = getMainColor();
					}
					if (opacity !== undefined && color.startsWith('rgba')) {
						return color.replace(/[\d.]+\)$/, opacity + ')');
					} else if (opacity !== undefined && color.startsWith('#')) {
						const hex = color.replace('#', '');
						const r = parseInt(hex.substr(0, 2), 16);
						const g = parseInt(hex.substr(2, 2), 16);
						const b = parseInt(hex.substr(4, 2), 16);
						return `rgba(${r}, ${g}, ${b}, ${opacity})`;
					}
					return color;
				};
				
				const swgColor = getChartColor('PRIMARY', 1);
				const vpnColor = getChartColor('SECONDARY', 1);
				const dlpColor = getChartColor('TERTIARY', 1);
				
				const labels = ['00', '01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11'];
				
				systemTrafficChart = new Chart(ctx, {
					type: 'line',
					data: {
						labels: labels,
						datasets: [
							{
								label: 'SWG',
								data: data.chart.SWG,
								borderColor: swgColor,
								backgroundColor: swgColor.replace('1)', '0.2)'),
								fill: true,
								borderWidth: 1,
								tension: 0.4
							},
							{
								label: 'VPN',
								data: data.chart.VPN,
								borderColor: vpnColor,
								backgroundColor: vpnColor.replace('1)', '0.2)'),
								fill: true,
								borderWidth: 1,
								tension: 0.4
							},
							{
								label: 'DLP',
								data: data.chart.DLP,
								borderColor: dlpColor,
								backgroundColor: dlpColor.replace('1)', '0.2)'),
								fill: true,
								borderWidth: 1,
								tension: 0.4
							}
						]
					},
					options: {
						responsive: true,
						maintainAspectRatio: false,
						plugins: {
							legend: {
								display: true,
								position: 'bottom',
								labels: {
									color: textColor,
									font: { size: 11 },
									usePointStyle: true,
									pointStyle: 'circle',
									boxWidth: 6,
									boxHeight: 6,
									padding: 8
								}
							},
							tooltip: {
								titleColor: '#FFF',
								bodyColor: '#FFF',
								backgroundColor: 'rgba(0, 0, 0, 0.9)',
								borderColor: 'rgba(255, 255, 255, 0.3)',
								borderWidth: 1
							}
						},
						scales: {
							x: {
								display: true,
								grid: {
									color: 'rgba(160, 160, 160, 0.3)',
									drawBorder: false
								},
								ticks: {
									color: textColor,
									font: { size: 11 }
								}
							},
							y: {
								display: true,
								beginAtZero: true,
								grid: {
									color: 'rgba(160, 160, 160, 0.3)',
									drawBorder: false
								},
								ticks: {
									color: textColor,
									font: { size: 11 }
								}
							}
						}
					}
				});
			}
			
			// IN/OUT 선택 업데이트 함수
			function updateTrafficType(type) {
				currentType = type;
				const data = trafficData[type];
				
				// 수치 업데이트
				$('#swgValue').text(data.SWG.toLocaleString());
				$('#vpnValue').text(data.VPN.toLocaleString());
				$('#dlpValue').text(data.DLP.toLocaleString());
				
				// 차트 업데이트
				if (systemTrafficChart) {
					systemTrafficChart.data.datasets[0].data = data.chart.SWG;
					systemTrafficChart.data.datasets[1].data = data.chart.VPN;
					systemTrafficChart.data.datasets[2].data = data.chart.DLP;
					systemTrafficChart.update();
				} else {
					initChart();
				}
			}
			
			// IN/OUT 클릭 이벤트
			$('#trafficSelector .demofont').on('click', function() {
				const type = $(this).data('type');
				if (type === currentType) return; // 이미 선택된 경우 무시
				
				// 클래스 업데이트: 선택된 것은 'demofont', 선택 안된 것은 'demofont off'
				$('#trafficSelector .demofont').each(function() {
					if ($(this).data('type') === type) {
						$(this).removeClass('off');
					} else {
						$(this).addClass('off');
					}
				});
				
				// 데이터 업데이트
				updateTrafficType(type);
			});
			
			// 초기 차트 생성
			if (typeof Chart !== 'undefined') {
				initChart();
			} else {
				console.warn('Chart.js not loaded');
			}
		});
		</script>
	</body>
</html>